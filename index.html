<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Live Info Board</title>
  <style>
    html, body {
      height: 100%;
      margin: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: sans-serif;
      background: #f7f7f7;
    }
    #info {
      font-size: clamp(2rem, 5vw, 8rem);
      padding: 1rem 2rem;
      background: white;
      border-radius: 1rem;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      text-align: center;
      /* allow newline characters in textContent to render as line breaks */
      white-space: pre-line;
    }
  </style>
  <!-- 1) Include the Pusher client library -->
  <script src="https://js.pusher.com/7.2/pusher.min.js"></script>
</head>
<body>
  <div id="info">Verifying â€¦</div>

  <script>
    /*
      2) Replace with your Pusher app credentials:
         - App Key    -> YOUR_APP_KEY
         - Cluster    -> YOUR_CLUSTER (e.g., 'eu')
      3) Use your chosen channel name below; it must match what you use in your API calls.
         Here we use 'ROIS-dev-live-info'.
    */
    const PUSHER_APP_KEY = 'd4e9c8ee117429f97f19';
    const PUSHER_CLUSTER = 'eu';
    const CHANNEL_NAME   = 'ROIS-dev-live-info';

    // 4) Initialize Pusher
    const pusher = new Pusher(PUSHER_APP_KEY, {
      cluster: PUSHER_CLUSTER,
      forceTLS: true
    });

    // 5) Subscribe to your channel
    const channel = pusher.subscribe(CHANNEL_NAME);

    // 6) Verification timeout: display 'OK' if no update arrives in 5s
    let updateReceived = false;
    const verifyTimeout = setTimeout(() => {
      if (!updateReceived) {
        document.getElementById('info').textContent = 'OK';
      }
    }, 2000);

    // 7) Bind the 'update' event: clear timeout and show data
    channel.bind('update', (data) => {
      updateReceived = true;
      clearTimeout(verifyTimeout);
      // display multi-line text correctly
      document.getElementById('info').textContent = data.text;
    });

    // 8) Handle connection errors
    pusher.connection.bind('error', (err) => {
      console.error('Pusher error', err);
      document.getElementById('info').textContent = 'DISCONNECTED';
    });
  </script>
</body>
</html>
